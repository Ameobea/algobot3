"use strict";
/*
Javascript for index page.
*/
$(document).ready(()=>{
  var serverAddress = "http://<%= ip %>";

  $("#backtestStartButton").click(()=>{
    var type = $("#backtestTypeSelector option:selected").text().toLowerCase();

    if(type == "fast"){
      var requestAddress = serverAddress + "api/backtest/start/fast/" + $("#backtestStartPair").val();
      $.post(requestAddress, {startTime: $("#backtestStartTime").val(), interval: $("#backtestSendInterval").val()});
    }else if(type == "live"){
      var requestAddress = serverAddress + "api/backtest/start/live/" + $("#backtestStartPair").val();
      $.post(requestAddress, {startTime: $("#backtestStartTime").val()});
    }else if(type == "pre-calculated"){
      var requestAddress = serverAddress + "api/backtest/start/precalced/" + $("#backtestStartPair").val();
      $.post(requestAddress, {startTime: $("#backtestStartTime").val(), endTime: $("#backtestEndTime").val()});
    }else if(type == "no-store"){
      console.log("pl");
      var requestAddress = serverAddress + "api/backtest/start/nostore/" + $("#backtestStartPair").val();
      $.post(requestAddress, {startTime: $("#backtestStartTime").val()});
    }
  });

  $("#backtestTypeSelector").change(()=>{
    if($("#backtestTypeSelector option:selected").text().toLowerCase() == "pre-calculated"){
      $("#endtime").show();
    }else{
      $("#endtime").hide();
    }
  });

  $("#backtestStopButton").click(()=>{
    var requestAddress = serverAddress + "api/backtest/stop/" + $("#backtestStopPair").val();
    $.post(requestAddress);
  });

  $("#backtestStopAllButton").click(()=>{
    var requestAddress = serverAddress + "api/backtest/stop/all";
    $.post(requestAddress);
  });

  $("#dbFlush").click(()=>{
    $.get("api/utils/dbFlush");
  });

  $("#dbDump").click(()=>{
    $.get("api/utils/dbDump");
  })

  $("#dbRestore").click(()=>{
    var restoreId = $("#dbRestoreId").val();
    $.get("api/utils/dbRestore/" + restoreId);
  });
});
